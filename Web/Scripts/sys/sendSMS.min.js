var pageManager=pageManager||{};pageManager=function(){var t=function(){tableName="Clients";i();r()},i=function(){var n=sUrl+"GetDataDirect",t=function(n,t){var i=$(t).map(function(n,t){var i=Object.keys(t);return $("<option />").val(t[i[0]]).text(t[i[1]])}).get();$(n).append(i);$(n).chosen()},i=function(n){var u=commonManger.decoData(n),f=u.list,i=u.list1,r;t("#CityID",f);i&&(r=$("#Message"),r.data("userid",i[0].Value),r.data("pass",i[1].Value),r.data("senderId",i[2].Value))};dataService.callAjax("GET",{actionName:"SMS_Properties"},n,i,commonManger.errorException)},r=function(){$("#CityID").change(function(){var n=$(this).val();n=n!=null&&n.length>1?n.join(","):n;f(n)});$("#SendAll").click(function(n){n.preventDefault();var t=$("#Message"),i=t.val(),r=u(),f=$("#Lang label.active :radio").val(),e={MobileNo:r,Message:i,Unicode:f?f:0,UserID:t.data("userid"),Password:t.data("pass"),SenderID:t.data("senderId")},o=function(n){var t=commonManger.jsnFromXML(n);t&&t.Status==="OK"?commonManger.showMessage("Success!:",t.Status+" Your Message Queued for Delivery."):commonManger.showMessage("SMS send results:",t.Error)};i!==""&&r.length>0?dataService.callAjax("POST",JSON.stringify(e),"/api/sms/SMSToGroup",o,commonManger.errorException):(alert("Please enter sms message."),$("#Message").focus())});var t="active",i=function(i,r){i=i?i:0;$("#"+gridId+" tbody > tr").each(function(n,u){(i===0||n<=i)&&(r?$(u).addClass(t).find("input[type=checkbox]").eq(0).prop("checked",!0):$(u).removeClass(t).find("input[type=checkbox]").eq(0).prop("checked",!1))});n()};$("#"+gridId+" > thead > tr > th input[type=checkbox]").eq(0).on("click",function(){var n=this.checked;i(undefined,n)});$("#"+gridId).on("click","td input[type=checkbox]",function(){var i=$(this).closest("tr");i.is(".detail-row ")||(this.checked?i.addClass(t):i.removeClass(t),n())});$("a.select-rows").click(function(n){n.preventDefault();var t=$(this).data("rows");t&&(i(undefined,!1),t===0?i(undefined,!0):i(t,!0))});autosize($("textarea[class*=autosize]"))},n=function(){var n=$("#"+gridId+" tbody tr.active").length;n>0&&commonManger.showMessage(n+" client(s) has been selected:","You have "+n+" clients selected for SMS message.")},u=function(){var n=[],t;return $("#"+gridId+" tbody tr.active td:last-child").each(function(){var t=uti.mobieFormat($(this).text());t&&t.length>10&&n.push(t)}),t=n.length>0?n.filter(function(n,t,i){return t===i.indexOf(n)}):[],t.join(";")},f=function(n){formName="aspnetForm";var t={actionName:tableName+"_ListByCity",value:n},i=function(n){var t,i;n=commonManger.decoData(n);t=n.list;t?(i=$(t).map(function(n,t){return'<tr><td class="center"><label class="pos-rel"><input name="no_'+t.Mobile+'" type="checkbox" class="ace"><span class="lbl"><\/span><\/label><\/td><td>'+t.ClientName+"<\/td><td>"+t.CityName+"<\/td><td>"+t.Mobile+"<\/td><\/tr>"}).get(),$("#"+gridId+" tbody").html(i),$("#clientsListPanel,#"+formName).removeClass("hidden")):($("#clientsListPanel,#"+formName).addClass("hidden"),$("#"+gridId+" tbody").html(""))};dataService.callAjax("GET",t,sUrl+"getdata",i,commonManger.errorException)};return{Init:t}}();