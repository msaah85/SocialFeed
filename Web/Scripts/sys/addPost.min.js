var newPostManager=function(){var n=function(){r();t()},t=function(){var n=function(n){n=commonManger.decoData(n).list;var t=["Facebook_Active","Facebook_PageURL","Facebook_AccessToken","Instagram_Active","Instagram_UserID","Instagram_Password","Facebook_PageID","Post_DefaultMessage"],u=$.grep(n,function(n){if(n.Name===t[0])return n.Value}),f=$.grep(n,function(n){if(n.Name===t[1])return n.Value}),e=$.grep(n,function(n){if(n.Name===t[6])return n.Value}),o=$.grep(n,function(n){if(n.Name===t[2])return n.Value}),s=$.grep(n,function(n){if(n.Name===t[3])return n.Value}),r=$.grep(n,function(n){if(n.Name===t[4])return n.Value}),h=$.grep(n,function(n){if(n.Name===t[5])return n.Value}),c=$.grep(n,function(n){if(n.Name===t[7])return n.Value}),i="";$("#message").val(c[0].Value);u[0].Value==="True"&&(i=`<div class="so-options" data-url="${f[0].Value}"  data-token="${o[0].Value}"><label class="middle"><input class="ace" type="checkbox" checked /><span class="lbl">Facebook</span></label>&nbsp;<i class="fa fa-arrow-right"></i> <a title="Open your page" href="http://facebook.com/${e[0].Value}" target="_blank"><i class="fa fa-2x fa-facebook"></i></a></div>`);s[0].Value==="True"&&(i+=`<div class="so-options" data-url="${r[0].Value}"  data-token="${h[0].Value}"><label class="middle"><input class="ace" type="checkbox" checked /><span class="lbl">Instagram</span></label>&nbsp;<i class="fa fa-arrow-right"></i> <a title="Open your page" href="http://instagram.com/${r[0].Value}" target="_blank"><i class="fa fa-2x fa-instagram"></i></a></div>`);$(".socialActivePages").html(i)};dataService.callAjax("GET",{actionName:"Settings_Social"},"/api/data/GetDataDirect",n,commonManger.errorException)},u=function(){var n=$("input[type=file]").eq(0).val().replace(/.*(\/|\\)/,"");return n.split(".")[0]},f=function(n){var t=function(n){console.log(n)},i={Name:n};dataService.callAjax("POST",JSON.stringify(i),"/api/Upload/Save",t,commonManger.errorException)},i=function(){var n={uRL:"/api/social/PostFeed",img:$("#post-image").attr("src"),fbCtrl:$(".so-options:eq(0)"),insCtrl:$(".so-options:eq(1)"),fbActive:function(){var n=this;return n.fbCtrl.find('input[type="checkbox"]').is(":checked")?!0:!1},insActive:function(){var n=this;return n.insCtrl.find('input[type="checkbox"]').is(":checked")?!0:!1},fbPostUrl:function(){var n=this;return n.fbCtrl.data("url")},fbToken:function(){var n=this;return n.fbCtrl.data("token")},insID:function(){var n=this;return n.insCtrl.data("url")},insToken:function(){var n=this;return n.insCtrl.data("token")},msg:$("#message").val(),imageBase64:function(){var n=this;return n.img&&n.img.length?n.img.split(",")[1]:""},showMessage:function(n,t){var i='<div class="alert alert-'+(n>1?"danger":"success")+'">'+t+"<\/div>";$(".message").html(i)},postedSocialCallBack:function(){n.showMessage(1,"This post has been added to your social page.");window.location.href="Social/Posts"}},t={Message:n.msg,ImageBase64:n.imageBase64(),FacebookActive:n.fbActive(),InstagramActive:n.insActive(),FacebookPostURL:n.fbPostUrl(),FacebookToken:n.fbToken(),InstagramID:n.insID(),InstagramToken:n.insToken()};if(n.imageBase64().length<5){commonManger.showMessage("Image is required","Please select an image.");$("#image2").closest("div.form-group").addClass("text-danger");return}if(t.Message===""){commonManger.showMessage("Message is required","Please enter post message.");$("#message").closest("div.form-group").addClass("text-danger");return}if(!t.FacebookActive&&!t.InstagramActive){commonManger.showMessage("Post to is required","Please select at least one from Post to.");$(".so-options").closest("div.form-group").addClass("text-danger");return}dataService.callAjax("POST",JSON.stringify(t),n.uRL,n.postedSocialCallBack,commonManger.errorException)},r=function(){$("#SendAll").click(function(n){n.preventDefault();i()});$("#image").ace_file_input({style:"well",btn_choose:"Drop image here or click to choose",btn_change:null,no_icon:"ace-icon fa fa-picture-o",droppable:!0,thumbnail:"large",whitelist:"gif|png|jpg|jpeg",blacklist:"exe|php|asp|aspx|txt|doc",allowExt:["jpeg","jpg","png","gif","bmp"],allowMime:["image/jpg","image/jpeg","image/png","image/gif","image/bmp"],before_change:function(n){for(var r,t,u=!0,i=0;i<n.length;i++)r=n[i],t=new Image,t.onload=function(){(!t||t.height<200&&t.width<200)&&(commonManger.showMessage("Too small !!!",`The image (${r.name}) is too small, please select a large image.`),$(".ace-file-input a.remove").trigger("click"),u=!1)},t.src=URL.createObjectURL(r);return u},before_remove:function(){return!0},preview_error:function(){}}).on("change",function(){var r=$(this)[0],t=r.files,i=t?t[0]:null,n;i&&(n=new FileReader,n.onloadend=function(){var t=$("span.ace-file-name");t&&t.data("src",n.result)},n.readAsDataURL(i))})};return{Init:n}}();newPostManager.Init();